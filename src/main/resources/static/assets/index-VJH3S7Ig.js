var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r,n=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&s(e,l,a[l]);if(r)for(var l of r(a))o.call(a,l)&&s(e,l,a[l]);return e},u=(e,a,l)=>new Promise(((r,t)=>{var o=e=>{try{n(l.next(e))}catch(a){t(a)}},s=e=>{try{n(l.throw(e))}catch(a){t(a)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);n((l=l.apply(e,a)).next())}));import{u as p,_ as i,a as d,b as c,A as m}from"./useCheckedColumns-CXiOr4VR.js";import{U as g,h as b,_ as f}from"./index-BJ9bV_jd.js";/* empty css                */import{_ as v}from"./ArtTable-CSqviyJT.js";/* empty css                    */import{R as h}from"./formData-CR0VZVZB.js";import{k as y,r as _,a2 as P,e as j,S as C,t as V,y as k,z as w,x as S,i as x,u as z,b4 as O,P as U,T as R,m as T,I,J as q,aV as A,b5 as N,a6 as E,a3 as L,a4 as $,L as B,ad as D,ae as J,E as F,_ as K,b6 as M,aw as W}from"./vendor-CAvuXLR8.js";import"./formEnum-BLgiZVxV.js";import"./vue-draggable-plus-BizZuMCK.js";/* empty css               *//* empty css               *//* empty css                       *//* empty css                       *//* empty css                   *//* empty css                 */const G={class:"account-page",id:"table-full-screen"},H={class:"dialog-footer"};var Q;const X=f(y((Q=n({},{name:"User"}),a(Q,l({__name:"index",setup(e){const a=_("add"),l=_(!1),r=_(!1),t={name:"",phone:"",address:"",level:"",email:"",date:"",daterange:"",status:"1"},o=_([]),s=P(n({},t)),f=P({currentPage:1,pageSize:20,total:0}),y=_([]),Q=_(),X=_([]),Y=()=>{Object.assign(s,n({},t)),f.currentPage=1,pe()},Z=()=>{f.currentPage=1,pe()},ee=e=>{},ae=[{label:"用户名",prop:"name",type:"input",config:{clearable:!0},onChange:ee},{label:"电话",prop:"phone",type:"input",config:{clearable:!0},onChange:ee},{label:"用户等级",prop:"level",type:"select",config:{clearable:!0},options:()=>[{label:"普通用户",value:"normal"},{label:"VIP用户",value:"vip"},{label:"高级VIP",value:"svip"},{label:"企业用户",value:"enterprise",disabled:!0}],onChange:ee},{label:"地址",prop:"address",type:"input",config:{clearable:!0},onChange:ee},{label:"邮箱",prop:"email",type:"input",config:{clearable:!0},onChange:ee},{prop:"date",label:"日期",type:"date",config:{type:"date",placeholder:"请选择日期"}},{prop:"daterange",label:"日期范围",type:"daterange",config:{type:"daterange",startPlaceholder:"开始时间",endPlaceholder:"结束时间"}},{label:"状态",prop:"status",type:"radio",options:[{label:"在线",value:"1"},{label:"离线",value:"2"}],onChange:ee}],le=[{label:"勾选",type:"selection"},{label:"用户名",prop:"avatar"},{label:"手机号",prop:"mobile"},{label:"性别",prop:"gender"},{label:"角色",prop:"role"},{label:"状态",prop:"userStatus"},{label:"创建日期",prop:"createTime"},{label:"操作",prop:"operation"}],re=e=>{switch(e){case 1:return"success";case 2:default:return"info";case 3:return"warning";case 0:return"danger"}},te=(e,r)=>{l.value=!0,a.value=e,ne.value&&ne.value.resetFields(),"edit"===e&&r?(ue.username=r.username,ue.phone=r.userPhone,ue.gender=1===r.gender?"男":"女",ue.role=Array.isArray(r.userRoles)?r.userRoles:[]):(ue.username="",ue.phone="",ue.gender="男",ue.role=[])},{columnChecks:oe,columns:se}=p((()=>[{type:"selection"},{prop:"avatar",label:"用户名",minWidth:220,formatter:e=>K("div",{class:"user",style:"display: flex; align-items: center"},[K("img",{class:"avatar",src:e.avatar}),K("div",{},[K("p",{class:"user-name"},`${e.realName} | ${e.userName}`),K("p",{class:"email"},e.email)])])},{prop:"gender",label:"性别",sortable:!0,formatter:e=>0===e.gender?"女":1===e.gender?"男":"未知"},{prop:"mobile",label:"手机号"},{prop:"userStatus",label:"状态",formatter:e=>K(M,{type:re(e.userStatus)},(()=>(e=>{let a="";return 0===e?a="禁用":1===e?a="启用":3===e?a="异常":4===e&&(a="注销"),a})(e.userStatus)))},{prop:"createTime",label:"创建日期",sortable:!0},{prop:"operation",label:"操作",width:150,formatter:e=>K("div",[K(m,{type:"edit",onClick:()=>te("edit",e)}),K(m,{type:"delete",onClick:()=>{W.confirm("确定要注销该用户吗？","注销用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((()=>{F.success("注销成功")}))}})])}])),ne=_(),ue=P({username:"",phone:"",gender:"",role:[]});j((()=>{pe(),ie()}));const pe=()=>u(this,null,(function*(){r.value=!0;try{const e={current:f.currentPage,size:f.pageSize},a=yield g.getUserPageList(e);a.code===b.success&&(y.value=a.data.records,r.value=!1,f.currentPage=a.data.current,f.pageSize=a.data.size,f.total=a.data.total)}catch(e){r.value=!1}})),ie=()=>{o.value=h},de=()=>{pe()},ce=e=>{X.value=e},me=P({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]}),ge=()=>u(this,null,(function*(){ne.value&&(yield ne.value.validate((e=>{e&&(F.success("add"===a.value?"添加成功":"更新成功"),l.value=!1)})))})),be=e=>{f.pageSize=e,pe()},fe=e=>{f.currentPage=e,pe()};return(e,t)=>{const n=i,u=U,p=d,m=A,g=v,b=B,h=$,_=J,P=D,j=L,F=O,K=c;return V(),C(K,null,{default:k((()=>[w("div",G,[S(n,{filter:z(s),"onUpdate:filter":t[0]||(t[0]=e=>x(s)?s.value=e:null),items:ae,onReset:Y,onSearch:Z},null,8,["filter"]),S(F,{shadow:"never",class:"art-table-card"},{default:k((()=>[S(p,{columnList:le,columns:z(oe),"onUpdate:columns":t[2]||(t[2]=e=>x(oe)?oe.value=e:null),onRefresh:de},{left:k((()=>[S(u,{onClick:t[1]||(t[1]=e=>te("add"))},{default:k((()=>t[9]||(t[9]=[R("新增用户")]))),_:1,__:[9]})])),_:1},8,["columns"]),S(g,{ref_key:"tableRef",ref:Q,"row-key":"id",loading:z(r),data:z(y),currentPage:z(f).currentPage,pageSize:z(f).pageSize,total:z(f).total,marginTop:10,onSelectionChange:ce,onSizeChange:be,onCurrentChange:fe},{default:k((()=>[(V(!0),T(I,null,q(z(se),(e=>(V(),C(m,N({key:e.prop||e.type},{ref_for:!0},e),null,16)))),128))])),_:1},8,["loading","data","currentPage","pageSize","total"]),S(z(E),{modelValue:z(l),"onUpdate:modelValue":t[8]||(t[8]=e=>x(l)?l.value=e:null),title:"add"===z(a)?"添加用户":"编辑用户",width:"30%","align-center":""},{footer:k((()=>[w("div",H,[S(u,{onClick:t[7]||(t[7]=e=>l.value=!1)},{default:k((()=>t[10]||(t[10]=[R("取消")]))),_:1,__:[10]}),S(u,{type:"primary",onClick:ge},{default:k((()=>t[11]||(t[11]=[R("提交")]))),_:1,__:[11]})])])),default:k((()=>[S(j,{ref_key:"formRef",ref:ne,model:z(ue),rules:z(me),"label-width":"80px"},{default:k((()=>[S(h,{label:"用户名",prop:"username"},{default:k((()=>[S(b,{modelValue:z(ue).username,"onUpdate:modelValue":t[3]||(t[3]=e=>z(ue).username=e)},null,8,["modelValue"])])),_:1}),S(h,{label:"手机号",prop:"phone"},{default:k((()=>[S(b,{modelValue:z(ue).phone,"onUpdate:modelValue":t[4]||(t[4]=e=>z(ue).phone=e)},null,8,["modelValue"])])),_:1}),S(h,{label:"性别",prop:"gender"},{default:k((()=>[S(P,{modelValue:z(ue).gender,"onUpdate:modelValue":t[5]||(t[5]=e=>z(ue).gender=e)},{default:k((()=>[S(_,{label:"男",value:"男"}),S(_,{label:"女",value:"女"})])),_:1},8,["modelValue"])])),_:1}),S(h,{label:"角色",prop:"role"},{default:k((()=>[S(P,{modelValue:z(ue).role,"onUpdate:modelValue":t[6]||(t[6]=e=>z(ue).role=e),multiple:""},{default:k((()=>[(V(!0),T(I,null,q(z(o),(e=>(V(),C(_,{key:e.roleCode,value:e.roleCode,label:e.roleName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])),_:1})])])),_:1})}}})))),[["__scopeId","data-v-535b7711"]]);export{X as default};
