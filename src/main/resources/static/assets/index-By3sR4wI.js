var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,n=(e,a)=>{for(var l in a||(a={}))u.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&r(e,l,a[l]);return e},i=(e,a,l)=>new Promise(((t,u)=>{var o=e=>{try{n(l.next(e))}catch(a){u(a)}},r=e=>{try{n(l.throw(e))}catch(a){u(a)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,r);n((l=l.apply(e,a)).next())}));import{u as s,_ as d,a as p,b as m,A as c}from"./useCheckedColumns-CCsh6VgT.js";import{i as f,b,C as h,I as v,D as _,_ as g}from"./index-fx4psQIV.js";/* empty css                */import{_ as y}from"./ArtIconSelector-CoJAn4J4.js";/* empty css               *//* empty css               *//* empty css                       *//* empty css                        */import{_ as k}from"./ArtTable-Dv6I4Fey.js";/* empty css                    */import{al as V,s as w,k as j,r as C,a2 as x,e as L,c as I,D as O,S as U,t as A,y as E,z as T,x as S,i as H,u as N,b2 as M,O as P,P as B,T as D,G as q,m as R,I as z,J,aT as F,b3 as K,a6 as W,a3 as $,v as G,a4 as X,aX as Z,aW as Q,aL as Y,aJ as ee,L as ae,ac as le,ab as te,E as ue,n as oe,_ as re,b4 as ne,as as ie,aw as se}from"./vendor-CRv0DxJL.js";import"./formEnum-BLgiZVxV.js";import"./vue-draggable-plus-BM7ts6S8.js";/* empty css                       */import"./iconfont-DPUoc2h2.js";/* empty css                   *//* empty css                 */const de=b(),pe={class:"menu-page",id:"table-full-screen"},me={class:"dialog-footer"};var ce;const fe=g(j((ce=n({},{name:"Menus"}),a(ce,l({__name:"index",setup(e){const{hasAuth:a}=(()=>{var e,a;const l=V(),{isFrontendMode:t}=f(),{info:u}=w(de),o=null!=(a=null==(e=u.value)?void 0:e.buttons)?a:[],r=Array.isArray(l.meta.authList)?l.meta.authList:[];return{hasAuth:e=>t.value?o.includes(e):r.some((a=>(null==a?void 0:a.auth_mark)===e))}})(),{menuList:l}=w(h()),t=C(!1),u={name:"",route:""},o=x(n({},u)),r=x(n({},u)),b=()=>{Object.assign(o,n({},u)),Object.assign(r,n({},u)),je()},g=()=>{Object.assign(r,n({},o)),je()},j=[{label:"菜单名称",prop:"name",type:"input",config:{clearable:!0}},{label:"路由地址",prop:"route",type:"input",config:{clearable:!0}}],ce=[{label:"勾选",type:"selection"},{label:"用户名",prop:"avatar"},{label:"手机号",prop:"mobile"},{label:"性别",prop:"sex"},{label:"部门",prop:"dep"},{label:"状态",prop:"status"},{label:"创建日期",prop:"create_time"},{label:"操作",prop:"operation"}],fe=e=>{var a,l,t;return e.children&&e.children.length>0?"info":(null==(a=e.meta)?void 0:a.link)&&(null==(l=e.meta)?void 0:l.isIframe)?"success":e.path?"primary":(null==(t=e.meta)?void 0:t.link)?"warning":void 0},{columnChecks:be,columns:he}=s((()=>[{prop:"meta.title",label:"菜单名称",minWidth:120,formatter:e=>{var a;return _(null==(a=e.meta)?void 0:a.title)}},{prop:"type",label:"菜单类型",formatter:e=>re(ne,{type:fe(e)},(()=>(e=>{var a,l,t;return e.children&&e.children.length>0?"目录":(null==(a=e.meta)?void 0:a.link)&&(null==(l=e.meta)?void 0:l.isIframe)?"内嵌":e.path?"菜单":(null==(t=e.meta)?void 0:t.link)?"外链":void 0})(e)))},{prop:"path",label:"路由",formatter:e=>{var a;return(null==(a=e.meta)?void 0:a.link)||e.path||""}},{prop:"meta.authList",label:"可操作权限",formatter:e=>{var a;return re("div",{},null==(a=e.meta.authList)?void 0:a.map(((e,a)=>re(ie,{placement:"top-start",title:"操作",width:200,trigger:"click",key:a},{default:()=>re("div",{style:"margin: 0; text-align: right"},[re(B,{size:"small",type:"primary",onClick:()=>Ee("button",e)},{default:()=>"编辑"}),re(B,{size:"small",type:"danger",onClick:()=>He()},{default:()=>"删除"})]),reference:()=>re(B,{class:"small-btn"},{default:()=>e.title})}))))}},{prop:"date",label:"编辑时间",formatter:()=>"2022-3-12 12:00:00"},{prop:"status",label:"隐藏菜单",formatter:e=>re(ne,{type:e.meta.isHide?"danger":"info"},(()=>e.meta.isHide?"是":"否"))},{prop:"operation",label:"操作",width:180,formatter:e=>re("div",[a("B_CODE1")&&re(c,{type:"add",onClick:()=>Ee("menu")}),a("B_CODE2")&&re(c,{type:"edit",onClick:()=>Oe("edit",e)}),a("B_CODE3")&&re(c,{type:"delete",onClick:()=>Se()})])}])),ve=()=>{je()},_e=C(!1),ge=x({name:"",path:"",label:"",icon:"",isEnable:!0,sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1}),ye=C(v.UNICODE),ke=C("menu"),Ve=x({name:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],label:[{required:!0,message:"输入权限标识",trigger:"blur"}],authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}],authLabel:[{required:!0,message:"请输入权限权限标识",trigger:"blur"}]}),we=C([]);L((()=>{je()}));const je=()=>{t.value=!0,setTimeout((()=>{we.value=l.value,t.value=!1}),500)},Ce=I((()=>{const e=a=>a.filter((a=>{var l,t,u;const o=(null==(l=r.name)?void 0:l.toLowerCase().trim())||"",n=(null==(t=r.route)?void 0:t.toLowerCase().trim())||"",i=_((null==(u=a.meta)?void 0:u.title)||"").toLowerCase(),s=(a.path||"").toLowerCase(),d=!o||i.includes(o),p=!n||s.includes(n);if(a.children&&a.children.length>0){const l=e(a.children);if(l.length>0)return a.children=l,!0}return d&&p}));return e(we.value)})),xe=C(!1),Le=C(),Ie=I((()=>{const e="menu"===ke.value?"菜单":"权限";return xe.value?`编辑${e}`:`新建${e}`})),Oe=(e,a)=>{Ee("menu",a,!0)},Ue=()=>{},Ae=()=>i(this,null,(function*(){Le.value&&(yield Le.value.validate((e=>i(this,null,(function*(){if(e)try{xe.value,ue.success((xe.value?"编辑":"新增")+"成功"),_e.value=!1}catch(a){ue.error((xe.value?"编辑":"新增")+"失败")}})))))})),Ee=(e,a,l=!1)=>{_e.value=!0,ke.value=e,xe.value=!1,Me.value=l,Te(),a&&(xe.value=!0,oe((()=>{"menu"===e?(ge.name=_(a.meta.title),ge.path=a.path,ge.label=a.name,ge.icon=a.meta.icon,ge.sort=a.meta.sort||1,ge.isMenu=a.meta.isMenu,ge.keepAlive=a.meta.keepAlive,ge.isHidden=a.meta.isHidden||!0,ge.isEnable=a.meta.isEnable||!0,ge.link=a.meta.link,ge.isIframe=a.meta.isIframe||!1):(ge.authName=a.title,ge.authLabel=a.auth_mark,ge.authIcon=a.icon||"",ge.authSort=a.sort||1)})))},Te=()=>{var e;null==(e=Le.value)||e.resetFields(),Object.assign(ge,{name:"",path:"",label:"",icon:"",sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1})},Se=()=>i(this,null,(function*(){try{yield se.confirm("确定要删除该菜单吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),ue.success("删除成功")}catch(e){"cancel"!==e&&ue.error("删除失败")}})),He=()=>i(this,null,(function*(){try{yield se.confirm("确定要删除该权限吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),ue.success("删除成功")}catch(e){"cancel"!==e&&ue.error("删除失败")}})),Ne=I((()=>!(!xe.value||"button"!==ke.value)||!(!xe.value||"menu"!==ke.value)||!(xe.value||"menu"!==ke.value||!Me.value))),Me=C(!1),Pe=C(!1),Be=C(),De=()=>{Pe.value=!Pe.value,oe((()=>{Be.value&&Be.value[Pe.value?"expandAll":"collapseAll"]()}))};return(e,a)=>{const l=d,u=p,r=F,n=k,i=Q,s=Z,c=X,f=ae,h=ee,v=Y,_=y,V=le,w=te,C=$,x=W,L=M,I=m,ue=O("auth"),oe=O("ripple");return A(),U(I,null,{default:E((()=>[T("div",pe,[S(l,{filter:N(o),"onUpdate:filter":a[0]||(a[0]=e=>H(o)?o.value=e:null),items:j,showExpand:!1,onReset:b,onSearch:g},null,8,["filter"]),S(L,{shadow:"never",class:"art-table-card"},{default:E((()=>[S(u,{columnList:ce,showZebra:!1,columns:N(be),"onUpdate:columns":a[2]||(a[2]=e=>H(be)?be.value=e:null),onRefresh:ve},{left:E((()=>[P((A(),U(N(B),{onClick:a[1]||(a[1]=e=>Ee("menu",null,!0))},{default:E((()=>a[19]||(a[19]=[D(" 添加菜单 ")]))),_:1,__:[19]})),[[ue,"add"],[oe]]),P((A(),U(N(B),{onClick:De},{default:E((()=>[D(q(N(Pe)?"收起":"展开"),1)])),_:1})),[[oe]])])),_:1},8,["columns"]),S(n,{rowKey:"path",ref_key:"tableRef",ref:Be,loading:N(t),data:N(Ce),marginTop:10,stripe:!1},{default:E((()=>[(A(!0),R(z,null,J(N(he),(e=>(A(),U(r,K({key:e.prop||e.type},{ref_for:!0},e),null,16)))),128))])),_:1},8,["loading","data"]),S(x,{title:N(Ie),modelValue:N(_e),"onUpdate:modelValue":a[18]||(a[18]=e=>H(_e)?_e.value=e:null),width:"700px","align-center":""},{footer:E((()=>[T("span",me,[S(N(B),{onClick:a[16]||(a[16]=e=>_e.value=!1)},{default:E((()=>a[22]||(a[22]=[D("取 消")]))),_:1,__:[22]}),S(N(B),{type:"primary",onClick:a[17]||(a[17]=e=>Ae())},{default:E((()=>a[23]||(a[23]=[D("确 定")]))),_:1,__:[23]})])])),default:E((()=>[S(C,{ref_key:"formRef",ref:Le,model:N(ge),rules:N(Ve),"label-width":"85px"},{default:E((()=>[S(c,{label:"菜单类型"},{default:E((()=>[S(s,{modelValue:N(ke),"onUpdate:modelValue":a[3]||(a[3]=e=>H(ke)?ke.value=e:null),disabled:N(Ne)},{default:E((()=>[S(i,{value:"menu",label:"menu"},{default:E((()=>a[20]||(a[20]=[D("菜单")]))),_:1,__:[20]}),S(i,{value:"button",label:"button"},{default:E((()=>a[21]||(a[21]=[D("权限")]))),_:1,__:[21]})])),_:1},8,["modelValue","disabled"])])),_:1}),"menu"===N(ke)?(A(),R(z,{key:0},[S(v,{gutter:20},{default:E((()=>[S(h,{span:12},{default:E((()=>[S(c,{label:"菜单名称",prop:"name"},{default:E((()=>[S(f,{modelValue:N(ge).name,"onUpdate:modelValue":a[4]||(a[4]=e=>N(ge).name=e),placeholder:"菜单名称"},null,8,["modelValue"])])),_:1})])),_:1}),S(h,{span:12},{default:E((()=>[S(c,{label:"路由地址",prop:"path"},{default:E((()=>[S(f,{modelValue:N(ge).path,"onUpdate:modelValue":a[5]||(a[5]=e=>N(ge).path=e),placeholder:"路由地址"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),S(v,{gutter:20},{default:E((()=>[S(h,{span:12},{default:E((()=>[S(c,{label:"权限标识",prop:"label"},{default:E((()=>[S(f,{modelValue:N(ge).label,"onUpdate:modelValue":a[6]||(a[6]=e=>N(ge).label=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1}),S(h,{span:12},{default:E((()=>[S(c,{label:"图标",prop:"icon"},{default:E((()=>[S(_,{iconType:N(ye),defaultIcon:N(ge).icon,width:"229px"},null,8,["iconType","defaultIcon"])])),_:1})])),_:1})])),_:1}),S(v,{gutter:20},{default:E((()=>[S(h,{span:12},{default:E((()=>[S(c,{label:"菜单排序",prop:"sort",style:{width:"100%"}},{default:E((()=>[S(V,{modelValue:N(ge).sort,"onUpdate:modelValue":a[7]||(a[7]=e=>N(ge).sort=e),style:{width:"100%"},onChange:Ue,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1}),S(h,{span:12},{default:E((()=>[S(c,{label:"外部链接",prop:"link"},{default:E((()=>[S(f,{modelValue:N(ge).link,"onUpdate:modelValue":a[8]||(a[8]=e=>N(ge).link=e),placeholder:"外部链接/内嵌地址(https://www.baidu.com)"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),S(v,{gutter:20},{default:E((()=>[S(h,{span:5},{default:E((()=>[S(c,{label:"是否启用",prop:"isEnable"},{default:E((()=>[S(w,{modelValue:N(ge).isEnable,"onUpdate:modelValue":a[9]||(a[9]=e=>N(ge).isEnable=e)},null,8,["modelValue"])])),_:1})])),_:1}),S(h,{span:5},{default:E((()=>[S(c,{label:"页面缓存",prop:"keepAlive"},{default:E((()=>[S(w,{modelValue:N(ge).keepAlive,"onUpdate:modelValue":a[10]||(a[10]=e=>N(ge).keepAlive=e)},null,8,["modelValue"])])),_:1})])),_:1}),S(h,{span:5},{default:E((()=>[S(c,{label:"是否显示",prop:"isHidden"},{default:E((()=>[S(w,{modelValue:N(ge).isHidden,"onUpdate:modelValue":a[11]||(a[11]=e=>N(ge).isHidden=e)},null,8,["modelValue"])])),_:1})])),_:1}),S(h,{span:5},{default:E((()=>[S(c,{label:"是否内嵌",prop:"isMenu"},{default:E((()=>[S(w,{modelValue:N(ge).isIframe,"onUpdate:modelValue":a[12]||(a[12]=e=>N(ge).isIframe=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):G("",!0),"button"===N(ke)?(A(),R(z,{key:1},[S(v,{gutter:20},{default:E((()=>[S(h,{span:12},{default:E((()=>[S(c,{label:"权限名称",prop:"authName"},{default:E((()=>[S(f,{modelValue:N(ge).authName,"onUpdate:modelValue":a[13]||(a[13]=e=>N(ge).authName=e),placeholder:"权限名称"},null,8,["modelValue"])])),_:1})])),_:1}),S(h,{span:12},{default:E((()=>[S(c,{label:"权限标识",prop:"authLabel"},{default:E((()=>[S(f,{modelValue:N(ge).authLabel,"onUpdate:modelValue":a[14]||(a[14]=e=>N(ge).authLabel=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),S(v,{gutter:20},{default:E((()=>[S(h,{span:12},{default:E((()=>[S(c,{label:"权限排序",prop:"authSort",style:{width:"100%"}},{default:E((()=>[S(V,{modelValue:N(ge).authSort,"onUpdate:modelValue":a[15]||(a[15]=e=>N(ge).authSort=e),style:{width:"100%"},onChange:Ue,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):G("",!0)])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])),_:1})])])),_:1})}}})))),[["__scopeId","data-v-44cbbeee"]]);export{fe as default};
