var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r,n=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&s(e,l,a[l]);if(r)for(var l of r(a))o.call(a,l)&&s(e,l,a[l]);return e},u=(e,r)=>a(e,l(r)),p=(e,a,l)=>new Promise(((r,t)=>{var o=e=>{try{n(l.next(e))}catch(a){t(a)}},s=e=>{try{n(l.throw(e))}catch(a){t(a)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);n((l=l.apply(e,a)).next())}));import{u as i,_ as d,a as c,b as m,A as g}from"./useCheckedColumns-N1oTEukQ.js";import{U as b,f,_ as v}from"./index-DppmMwQA.js";/* empty css                */import{_ as h}from"./ArtTable-C3jVcZ-t.js";/* empty css                    */import{A as y,R as _}from"./formData-BpbC76O8.js";import{k as P,r as j,a2 as C,e as V,S as k,t as w,y as x,z as S,x as z,i as O,u as U,b2 as T,P as R,T as A,m as I,I as q,J as E,aT as L,b3 as N,a6 as B,a3 as D,a4 as G,L as J,ad as F,ae as K,E as M,_ as Q,b4 as W,aw as $}from"./vendor-CRv0DxJL.js";import"./formEnum-BLgiZVxV.js";import"./vue-draggable-plus-BM7ts6S8.js";/* empty css               *//* empty css               *//* empty css                       *//* empty css                       *//* empty css                   *//* empty css                 */import"./avatar9-oKrDyQhv.js";const H={class:"account-page",id:"table-full-screen"},X={class:"dialog-footer"},Y=v(P(u(n({},{name:"User"}),{__name:"index",setup(e){const a=j("add"),l=j(!1),r=j(!1),t={name:"",phone:"",address:"",level:"",email:"",date:"",daterange:"",status:"1"},o=j([]),s=C(n({},t)),v=C({currentPage:1,pageSize:20,total:0}),P=j([]),Y=j(),Z=j([]),ee=()=>{Object.assign(s,n({},t)),v.currentPage=1,de()},ae=()=>{v.currentPage=1,de()},le=e=>{},re=[{label:"用户名",prop:"name",type:"input",config:{clearable:!0},onChange:le},{label:"电话",prop:"phone",type:"input",config:{clearable:!0},onChange:le},{label:"用户等级",prop:"level",type:"select",config:{clearable:!0},options:()=>[{label:"普通用户",value:"normal"},{label:"VIP用户",value:"vip"},{label:"高级VIP",value:"svip"},{label:"企业用户",value:"enterprise",disabled:!0}],onChange:le},{label:"地址",prop:"address",type:"input",config:{clearable:!0},onChange:le},{label:"邮箱",prop:"email",type:"input",config:{clearable:!0},onChange:le},{prop:"date",label:"日期",type:"date",config:{type:"date",placeholder:"请选择日期"}},{prop:"daterange",label:"日期范围",type:"daterange",config:{type:"daterange",startPlaceholder:"开始时间",endPlaceholder:"结束时间"}},{label:"状态",prop:"status",type:"radio",options:[{label:"在线",value:"1"},{label:"离线",value:"2"}],onChange:le}],te=[{label:"勾选",type:"selection"},{label:"用户名",prop:"avatar"},{label:"手机号",prop:"userPhone"},{label:"性别",prop:"gender"},{label:"角色",prop:"role"},{label:"状态",prop:"status"},{label:"创建日期",prop:"createTime"},{label:"操作",prop:"operation"}],oe=e=>{switch(e){case"1":return"success";case"2":default:return"info";case"3":return"warning";case"4":return"danger"}},se=(e,r)=>{l.value=!0,a.value=e,pe.value&&pe.value.resetFields(),"edit"===e&&r?(ie.username=r.username,ie.phone=r.userPhone,ie.gender=1===r.gender?"男":"女",ie.role=Array.isArray(r.userRoles)?r.userRoles:[]):(ie.username="",ie.phone="",ie.gender="男",ie.role=[])},{columnChecks:ne,columns:ue}=i((()=>[{type:"selection"},{prop:"avatar",label:"用户名",minWidth:220,formatter:e=>Q("div",{class:"user",style:"display: flex; align-items: center"},[Q("img",{class:"avatar",src:e.avatar}),Q("div",{},[Q("p",{class:"user-name"},e.userName),Q("p",{class:"email"},e.userEmail)])])},{prop:"userGender",label:"性别",sortable:!0,formatter:e=>1===e.userGender?"男":"女"},{prop:"userPhone",label:"手机号"},{prop:"status",label:"状态",formatter:e=>Q(W,{type:oe(e.status)},(()=>(e=>{let a="";return"1"===e?a="在线":"2"===e?a="离线":"3"===e?a="异常":"4"===e&&(a="注销"),a})(e.status)))},{prop:"createTime",label:"创建日期",sortable:!0},{prop:"operation",label:"操作",width:150,formatter:e=>Q("div",[Q(g,{type:"edit",onClick:()=>se("edit",e)}),Q(g,{type:"delete",onClick:()=>{$.confirm("确定要注销该用户吗？","注销用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((()=>{M.success("注销成功")}))}})])}])),pe=j(),ie=C({username:"",phone:"",gender:"",role:[]});V((()=>{de(),ce()}));const de=()=>p(this,null,(function*(){r.value=!0;try{const e={current:v.currentPage,size:v.pageSize},a=yield b.getUserList(e);if(a.code===f.success){const e=a.data.records.map(((e,a)=>{const l=a%y.length;return u(n({},e),{avatar:y[l].avatar})}));P.value=e,r.value=!1,v.currentPage=a.data.current,v.pageSize=a.data.size,v.total=a.data.total}}catch(e){r.value=!1}})),ce=()=>{o.value=_},me=()=>{de()},ge=e=>{Z.value=e},be=C({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]}),fe=()=>p(this,null,(function*(){pe.value&&(yield pe.value.validate((e=>{e&&(M.success("add"===a.value?"添加成功":"更新成功"),l.value=!1)})))})),ve=e=>{v.pageSize=e,de()},he=e=>{v.currentPage=e,de()};return(e,t)=>{const n=d,u=R,p=c,i=L,g=h,b=J,f=G,y=K,_=F,j=D,C=T,V=m;return w(),k(V,null,{default:x((()=>[S("div",H,[z(n,{filter:U(s),"onUpdate:filter":t[0]||(t[0]=e=>O(s)?s.value=e:null),items:re,onReset:ee,onSearch:ae},null,8,["filter"]),z(C,{shadow:"never",class:"art-table-card"},{default:x((()=>[z(p,{columnList:te,columns:U(ne),"onUpdate:columns":t[2]||(t[2]=e=>O(ne)?ne.value=e:null),onRefresh:me},{left:x((()=>[z(u,{onClick:t[1]||(t[1]=e=>se("add"))},{default:x((()=>t[9]||(t[9]=[A("新增用户")]))),_:1,__:[9]})])),_:1},8,["columns"]),z(g,{ref_key:"tableRef",ref:Y,"row-key":"id",loading:U(r),data:U(P),currentPage:U(v).currentPage,pageSize:U(v).pageSize,total:U(v).total,marginTop:10,onSelectionChange:ge,onSizeChange:ve,onCurrentChange:he},{default:x((()=>[(w(!0),I(q,null,E(U(ue),(e=>(w(),k(i,N({key:e.prop||e.type},{ref_for:!0},e),null,16)))),128))])),_:1},8,["loading","data","currentPage","pageSize","total"]),z(U(B),{modelValue:U(l),"onUpdate:modelValue":t[8]||(t[8]=e=>O(l)?l.value=e:null),title:"add"===U(a)?"添加用户":"编辑用户",width:"30%","align-center":""},{footer:x((()=>[S("div",X,[z(u,{onClick:t[7]||(t[7]=e=>l.value=!1)},{default:x((()=>t[10]||(t[10]=[A("取消")]))),_:1,__:[10]}),z(u,{type:"primary",onClick:fe},{default:x((()=>t[11]||(t[11]=[A("提交")]))),_:1,__:[11]})])])),default:x((()=>[z(j,{ref_key:"formRef",ref:pe,model:U(ie),rules:U(be),"label-width":"80px"},{default:x((()=>[z(f,{label:"用户名",prop:"username"},{default:x((()=>[z(b,{modelValue:U(ie).username,"onUpdate:modelValue":t[3]||(t[3]=e=>U(ie).username=e)},null,8,["modelValue"])])),_:1}),z(f,{label:"手机号",prop:"phone"},{default:x((()=>[z(b,{modelValue:U(ie).phone,"onUpdate:modelValue":t[4]||(t[4]=e=>U(ie).phone=e)},null,8,["modelValue"])])),_:1}),z(f,{label:"性别",prop:"gender"},{default:x((()=>[z(_,{modelValue:U(ie).gender,"onUpdate:modelValue":t[5]||(t[5]=e=>U(ie).gender=e)},{default:x((()=>[z(y,{label:"男",value:"男"}),z(y,{label:"女",value:"女"})])),_:1},8,["modelValue"])])),_:1}),z(f,{label:"角色",prop:"role"},{default:x((()=>[z(_,{modelValue:U(ie).role,"onUpdate:modelValue":t[6]||(t[6]=e=>U(ie).role=e),multiple:""},{default:x((()=>[(w(!0),I(q,null,E(U(o),(e=>(w(),k(y,{key:e.roleCode,value:e.roleCode,label:e.roleName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])),_:1})])])),_:1})}}})),[["__scopeId","data-v-2702fb19"]]);export{Y as default};
