var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,r=(e,l)=>{for(var a in l||(l={}))u.call(l,a)&&n(e,a,l[a]);if(t)for(var a of t(l))o.call(l,a)&&n(e,a,l[a]);return e},i=(e,l,a)=>new Promise(((t,u)=>{var o=e=>{try{r(a.next(e))}catch(l){u(l)}},n=e=>{try{r(a.throw(e))}catch(l){u(l)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,n);r((a=a.apply(e,l)).next())}));import{u as s,_ as d,a as p,b as m,A as c}from"./useCheckedColumns-3eLpf4pv.js";import{i as f,b,D as h,I as v,F as _,_ as g}from"./index-YXQx44uA.js";/* empty css                */import{_ as y}from"./ArtIconSelector-uo2Eo4SN.js";/* empty css               *//* empty css               *//* empty css                       *//* empty css                        */import{_ as k}from"./ArtTable-ta3JfkYh.js";/* empty css                    */import{al as V,s as w,k as j,r as x,a2 as C,e as I,c as L,D as U,S as A,t as O,y as E,z as S,x as M,i as T,u as H,b9 as N,O as P,P as q,T as B,G as D,m as R,I as z,J as F,a_ as K,ba as $,a6 as G,a3 as J,v as Q,a4 as W,b2 as Z,b1 as X,aS as Y,aQ as ee,L as le,ac as ae,ab as te,E as ue,n as oe,_ as ne,bb as re,as as ie,aw as se}from"./vendor-C0Cq8Zey.js";import"./formEnum-BLgiZVxV.js";import"./vue-draggable-plus-CEKPM1PI.js";/* empty css                       */import"./iconfont-DPUoc2h2.js";/* empty css                   *//* empty css                 */const de=b(),pe={class:"menu-page",id:"table-full-screen"},me={class:"dialog-footer"};var ce;const fe=g(j((ce=r({},{name:"Menus"}),l(ce,a({__name:"index",setup(e){const{hasAuth:l}=(()=>{var e,l;const a=V(),{isFrontendMode:t}=f(),{info:u}=w(de),o=null!=(l=null==(e=u.value)?void 0:e.buttons)?l:[],n=Array.isArray(a.meta.authList)?a.meta.authList:[];return{hasAuth:e=>t.value?o.includes(e):n.some((l=>(null==l?void 0:l.authMark)===e))}})(),{menuList:a}=w(h()),t=x(!1),u={name:"",route:""},o=C(r({},u)),n=C(r({},u)),b=()=>{Object.assign(o,r({},u)),Object.assign(n,r({},u)),je()},g=()=>{Object.assign(n,r({},o)),je()},j=[{label:"菜单名称",prop:"name",type:"input",config:{clearable:!0}},{label:"路由地址",prop:"route",type:"input",config:{clearable:!0}}],ce=[{label:"勾选",type:"selection"},{label:"用户名",prop:"avatar"},{label:"手机号",prop:"mobile"},{label:"性别",prop:"sex"},{label:"部门",prop:"dep"},{label:"状态",prop:"status"},{label:"创建日期",prop:"create_time"},{label:"操作",prop:"operation"}],fe=e=>{var l,a,t;return e.children&&e.children.length>0?"info":(null==(l=e.meta)?void 0:l.link)&&(null==(a=e.meta)?void 0:a.isIframe)?"success":e.path?"primary":(null==(t=e.meta)?void 0:t.link)?"warning":void 0},{columnChecks:be,columns:he}=s((()=>[{prop:"meta.title",label:"菜单名称",minWidth:120,formatter:e=>{var l;return _(null==(l=e.meta)?void 0:l.title)}},{prop:"type",label:"菜单类型",formatter:e=>ne(re,{type:fe(e)},(()=>(e=>{var l,a,t,u;return e.children&&e.children.length>0?"目录":(null==(l=e.meta)?void 0:l.link)&&(null==(a=e.meta)?void 0:a.isIframe)?"菜单（内嵌）":e.path&&!(null==(t=e.meta)?void 0:t.link)?"菜单":(null==(u=e.meta)?void 0:u.link)?"菜单（外链）":void 0})(e)))},{prop:"path",label:"路由",formatter:e=>{var l;return(null==(l=e.meta)?void 0:l.link)||e.path||""}},{prop:"meta.authList",label:"可操作权限",formatter:e=>{var l;return ne("div",{},null==(l=e.meta.authList)?void 0:l.map(((e,l)=>ne(ie,{placement:"top-start",title:"操作",width:200,trigger:"click",key:l},{default:()=>ne("div",{style:"margin: 0; text-align: right"},[ne(q,{size:"small",type:"primary",onClick:()=>Ee("button",e)},{default:()=>"编辑"}),ne(q,{size:"small",type:"danger",onClick:()=>Te()},{default:()=>"删除"})]),reference:()=>ne(q,{class:"small-btn"},{default:()=>e.title})}))))}},{prop:"date",label:"编辑时间",formatter:()=>"2022-3-12 12:00:00"},{prop:"status",label:"隐藏菜单",formatter:e=>ne(re,{type:e.meta.isHide?"danger":"info"},(()=>e.meta.isHide?"是":"否"))},{prop:"operation",label:"操作",width:180,formatter:e=>ne("div",[l("menu/add")&&ne(c,{type:"add",onClick:()=>Ee("menu")}),l("menu/update")&&ne(c,{type:"edit",onClick:()=>Ue("edit",e)}),l("menu/del")&&ne(c,{type:"delete",onClick:()=>Me()})])}])),ve=()=>{je()},_e=x(!1),ge=C({name:"",path:"",label:"",icon:"",isEnable:!0,sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1}),ye=x(v.UNICODE),ke=x("menu"),Ve=C({name:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],label:[{required:!0,message:"输入权限标识",trigger:"blur"}],authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}],authLabel:[{required:!0,message:"请输入权限权限标识",trigger:"blur"}]}),we=x([]);I((()=>{je()}));const je=()=>{t.value=!0,setTimeout((()=>{we.value=a.value,t.value=!1}),500)},xe=L((()=>{const e=l=>l.filter((l=>{var a,t,u;const o=(null==(a=n.name)?void 0:a.toLowerCase().trim())||"",r=(null==(t=n.route)?void 0:t.toLowerCase().trim())||"",i=_((null==(u=l.meta)?void 0:u.title)||"").toLowerCase(),s=(l.path||"").toLowerCase(),d=!o||i.includes(o),p=!r||s.includes(r);if(l.children&&l.children.length>0){const a=e(l.children);if(a.length>0)return l.children=a,!0}return d&&p}));return e(we.value)})),Ce=x(!1),Ie=x(),Le=L((()=>{const e="menu"===ke.value?"菜单":"权限";return Ce.value?`编辑${e}`:`新建${e}`})),Ue=(e,l)=>{Ee("menu",l,!0)},Ae=()=>{},Oe=()=>i(this,null,(function*(){Ie.value&&(yield Ie.value.validate((e=>i(this,null,(function*(){if(e)try{Ce.value,ue.success((Ce.value?"编辑":"新增")+"成功"),_e.value=!1}catch(l){ue.error((Ce.value?"编辑":"新增")+"失败")}})))))})),Ee=(e,l,a=!1)=>{_e.value=!0,ke.value=e,Ce.value=!1,Ne.value=a,Se(),l&&(Ce.value=!0,oe((()=>{"menu"===e?(ge.name=_(l.meta.title),ge.path=l.path,ge.label=l.name,ge.icon=l.meta.icon,ge.sort=l.meta.sort||1,ge.isMenu=l.meta.isMenu,ge.keepAlive=l.meta.keepAlive,ge.isHidden=l.meta.isHidden||!0,ge.isEnable=l.meta.isEnable||!0,ge.link=l.meta.link,ge.isIframe=l.meta.isIframe||!1):(ge.authName=l.title,ge.authLabel=l.authMark,ge.authIcon=l.icon||"",ge.authSort=l.sort||1)})))},Se=()=>{var e;null==(e=Ie.value)||e.resetFields(),Object.assign(ge,{name:"",path:"",label:"",icon:"",sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1})},Me=()=>i(this,null,(function*(){try{yield se.confirm("确定要删除该菜单吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),ue.success("删除成功")}catch(e){"cancel"!==e&&ue.error("删除失败")}})),Te=()=>i(this,null,(function*(){try{yield se.confirm("确定要删除该权限吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),ue.success("删除成功")}catch(e){"cancel"!==e&&ue.error("删除失败")}})),He=L((()=>!(!Ce.value||"button"!==ke.value)||!(!Ce.value||"menu"!==ke.value)||!(Ce.value||"menu"!==ke.value||!Ne.value))),Ne=x(!1),Pe=x(!1),qe=x(),Be=()=>{Pe.value=!Pe.value,oe((()=>{qe.value&&qe.value[Pe.value?"expandAll":"collapseAll"]()}))};return(e,l)=>{const a=d,u=p,n=K,r=k,i=X,s=Z,c=W,f=le,h=ee,v=Y,_=y,V=ae,w=te,x=J,C=G,I=N,L=m,ue=U("auth"),oe=U("ripple");return O(),A(L,null,{default:E((()=>[S("div",pe,[M(a,{filter:H(o),"onUpdate:filter":l[0]||(l[0]=e=>T(o)?o.value=e:null),items:j,showExpand:!1,onReset:b,onSearch:g},null,8,["filter"]),M(I,{shadow:"never",class:"art-table-card"},{default:E((()=>[M(u,{columnList:ce,showZebra:!1,columns:H(be),"onUpdate:columns":l[2]||(l[2]=e=>T(be)?be.value=e:null),onRefresh:ve},{left:E((()=>[P((O(),A(H(q),{onClick:l[1]||(l[1]=e=>Ee("menu",null,!0))},{default:E((()=>l[19]||(l[19]=[B(" 添加菜单 ")]))),_:1,__:[19]})),[[ue,"menu/add"],[oe]]),P((O(),A(H(q),{onClick:Be},{default:E((()=>[B(D(H(Pe)?"收起":"展开"),1)])),_:1})),[[oe]])])),_:1},8,["columns"]),M(r,{rowKey:"path",ref_key:"tableRef",ref:qe,loading:H(t),data:H(xe),marginTop:10,stripe:!1},{default:E((()=>[(O(!0),R(z,null,F(H(he),(e=>(O(),A(n,$({key:e.prop||e.type},{ref_for:!0},e),null,16)))),128))])),_:1},8,["loading","data"]),M(C,{title:H(Le),modelValue:H(_e),"onUpdate:modelValue":l[18]||(l[18]=e=>T(_e)?_e.value=e:null),width:"700px","align-center":""},{footer:E((()=>[S("span",me,[M(H(q),{onClick:l[16]||(l[16]=e=>_e.value=!1)},{default:E((()=>l[22]||(l[22]=[B("取 消")]))),_:1,__:[22]}),M(H(q),{type:"primary",onClick:l[17]||(l[17]=e=>Oe())},{default:E((()=>l[23]||(l[23]=[B("确 定")]))),_:1,__:[23]})])])),default:E((()=>[M(x,{ref_key:"formRef",ref:Ie,model:H(ge),rules:H(Ve),"label-width":"85px"},{default:E((()=>[M(c,{label:"菜单类型"},{default:E((()=>[M(s,{modelValue:H(ke),"onUpdate:modelValue":l[3]||(l[3]=e=>T(ke)?ke.value=e:null),disabled:H(He)},{default:E((()=>[M(i,{value:"menu",label:"menu"},{default:E((()=>l[20]||(l[20]=[B("菜单")]))),_:1,__:[20]}),M(i,{value:"button",label:"button"},{default:E((()=>l[21]||(l[21]=[B("权限")]))),_:1,__:[21]})])),_:1},8,["modelValue","disabled"])])),_:1}),"menu"===H(ke)?(O(),R(z,{key:0},[M(v,{gutter:20},{default:E((()=>[M(h,{span:12},{default:E((()=>[M(c,{label:"菜单名称",prop:"name"},{default:E((()=>[M(f,{modelValue:H(ge).name,"onUpdate:modelValue":l[4]||(l[4]=e=>H(ge).name=e),placeholder:"菜单名称"},null,8,["modelValue"])])),_:1})])),_:1}),M(h,{span:12},{default:E((()=>[M(c,{label:"路由地址",prop:"path"},{default:E((()=>[M(f,{modelValue:H(ge).path,"onUpdate:modelValue":l[5]||(l[5]=e=>H(ge).path=e),placeholder:"路由地址"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),M(v,{gutter:20},{default:E((()=>[M(h,{span:12},{default:E((()=>[M(c,{label:"权限标识",prop:"label"},{default:E((()=>[M(f,{modelValue:H(ge).label,"onUpdate:modelValue":l[6]||(l[6]=e=>H(ge).label=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1}),M(h,{span:12},{default:E((()=>[M(c,{label:"图标",prop:"icon"},{default:E((()=>[M(_,{iconType:H(ye),defaultIcon:H(ge).icon,width:"229px"},null,8,["iconType","defaultIcon"])])),_:1})])),_:1})])),_:1}),M(v,{gutter:20},{default:E((()=>[M(h,{span:12},{default:E((()=>[M(c,{label:"菜单排序",prop:"sort",style:{width:"100%"}},{default:E((()=>[M(V,{modelValue:H(ge).sort,"onUpdate:modelValue":l[7]||(l[7]=e=>H(ge).sort=e),style:{width:"100%"},onChange:Ae,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1}),M(h,{span:12},{default:E((()=>[M(c,{label:"外部链接",prop:"link"},{default:E((()=>[M(f,{modelValue:H(ge).link,"onUpdate:modelValue":l[8]||(l[8]=e=>H(ge).link=e),placeholder:"外部链接/内嵌地址(https://www.baidu.com)"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),M(v,{gutter:20},{default:E((()=>[M(h,{span:5},{default:E((()=>[M(c,{label:"是否启用",prop:"isEnable"},{default:E((()=>[M(w,{modelValue:H(ge).isEnable,"onUpdate:modelValue":l[9]||(l[9]=e=>H(ge).isEnable=e)},null,8,["modelValue"])])),_:1})])),_:1}),M(h,{span:5},{default:E((()=>[M(c,{label:"页面缓存",prop:"keepAlive"},{default:E((()=>[M(w,{modelValue:H(ge).keepAlive,"onUpdate:modelValue":l[10]||(l[10]=e=>H(ge).keepAlive=e)},null,8,["modelValue"])])),_:1})])),_:1}),M(h,{span:5},{default:E((()=>[M(c,{label:"是否显示",prop:"isHidden"},{default:E((()=>[M(w,{modelValue:H(ge).isHidden,"onUpdate:modelValue":l[11]||(l[11]=e=>H(ge).isHidden=e)},null,8,["modelValue"])])),_:1})])),_:1}),M(h,{span:5},{default:E((()=>[M(c,{label:"是否内嵌",prop:"isMenu"},{default:E((()=>[M(w,{modelValue:H(ge).isIframe,"onUpdate:modelValue":l[12]||(l[12]=e=>H(ge).isIframe=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):Q("",!0),"button"===H(ke)?(O(),R(z,{key:1},[M(v,{gutter:20},{default:E((()=>[M(h,{span:12},{default:E((()=>[M(c,{label:"权限名称",prop:"authName"},{default:E((()=>[M(f,{modelValue:H(ge).authName,"onUpdate:modelValue":l[13]||(l[13]=e=>H(ge).authName=e),placeholder:"权限名称"},null,8,["modelValue"])])),_:1})])),_:1}),M(h,{span:12},{default:E((()=>[M(c,{label:"权限标识",prop:"authLabel"},{default:E((()=>[M(f,{modelValue:H(ge).authLabel,"onUpdate:modelValue":l[14]||(l[14]=e=>H(ge).authLabel=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),M(v,{gutter:20},{default:E((()=>[M(h,{span:12},{default:E((()=>[M(c,{label:"权限排序",prop:"authSort",style:{width:"100%"}},{default:E((()=>[M(V,{modelValue:H(ge).authSort,"onUpdate:modelValue":l[15]||(l[15]=e=>H(ge).authSort=e),style:{width:"100%"},onChange:Ae,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):Q("",!0)])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])),_:1})])])),_:1})}}})))),[["__scopeId","data-v-0e6e1e77"]]);export{fe as default};
