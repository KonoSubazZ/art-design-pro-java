import{_ as e,c as a,u as t,m as s,d as l,j as o,e as r,S as i,L as n,M as d,g as u,R as c,N as g,U as p,n as h,H as v}from"./index-BHy-qhsq.js";/* empty css                    */import{h as f,m,t as y,r as x,o as w,a as b,l as _,c as k,d as T,e as M,a3 as B,u as L,a6 as $,X as I,j as V,P,ae as S,p as C,aU as R,aV as X,aW as j,N as H,s as U,f as A,J as D,aR as E,aA as O,T as F,Q as K,W as z,V as Y,I as q,aP as N,$ as Q,a0 as W,aQ as G,K as J,R as Z,S as ee,aX as ae,aY as te,v as se,a7 as le,U as oe,i as re,L as ie,aZ as ne}from"./vendor-CbDhNKi9.js";import{_ as de}from"./LoginLeftView-gp1OAADN.js";import{S as ue}from"./sysApi-BNJpJOJn.js";import"./lf_icon2-Byh5fA9S.js";const ce=["innerHTML"],ge=e(f({__name:"ArtDragVerify",props:{value:{type:Boolean,default:!1},width:{default:260},height:{default:38},text:{default:"按住滑块拖动"},successText:{default:"success"},background:{default:"#eee"},progressBarBg:{default:"#1385FF"},completedBg:{default:"#57D187"},circle:{type:Boolean,default:!1},radius:{default:"calc(var(--custom-radius) / 3 + 2px)"},handlerIcon:{default:"&#xea50;"},successIcon:{default:"&#xe621;"},handlerBg:{default:"#fff"},textSize:{default:"13px"},textColor:{default:"#333"}},emits:["handlerMove","update:value","passCallback"],setup(e,{expose:a,emit:t}){const s=t,l=e,o=m({isMoving:!1,x:0,isOk:!1}),{isOk:r}=y(o),i=x(),n=x(),d=x(),u=x();let c,g,p,h;const v=e=>{c=e.targetTouches[0].pageX,g=e.targetTouches[0].pageY},f=e=>{p=e.targetTouches[0].pageX,h=e.targetTouches[0].pageY,Math.abs(p-c)>Math.abs(h-g)&&e.preventDefault()};document.addEventListener("touchstart",v),document.addEventListener("touchmove",f,{passive:!1}),w((()=>{i.value?.style.setProperty("--textColor",l.textColor),i.value?.style.setProperty("--width",Math.floor(l.width/2)+"px"),i.value?.style.setProperty("--pwidth",-Math.floor(l.width/2)+"px"),document.addEventListener("touchstart",v),document.addEventListener("touchmove",f,{passive:!1})})),b((()=>{document.removeEventListener("touchstart",v),document.removeEventListener("touchmove",f)}));const S={left:"0",width:l.height+"px",height:l.height+"px",background:l.handlerBg},C={width:l.width+"px",height:l.height+"px",lineHeight:l.height+"px",background:l.background,borderRadius:l.circle?l.height/2+"px":l.radius},R={background:l.progressBarBg,height:l.height+"px",borderRadius:l.circle?l.height/2+"px 0 0 "+l.height/2+"px":l.radius},X={height:l.height+"px",width:l.width+"px",fontSize:l.textSize},j=_((()=>l.value?l.successText:l.text)),H=e=>{l.value||(o.isMoving=!0,d.value.style.transition="none",o.x=(e.pageX||e.touches[0].pageX)-parseInt(d.value.style.left.replace("px",""),10)),s("handlerMove")},U=e=>{if(o.isMoving&&!l.value){let a=(e.pageX||e.touches[0].pageX)-o.x;a>0&&a<=l.width-l.height?(d.value.style.left=a+"px",u.value.style.width=a+l.height/2+"px"):a>l.width-l.height&&(d.value.style.left=l.width-l.height+"px",u.value.style.width=l.width-l.height/2+"px",D())}},A=e=>{if(o.isMoving&&!l.value){(e.pageX||e.changedTouches[0].pageX)-o.x<l.width-l.height?(o.isOk=!0,d.value.style.left="0",d.value.style.transition="all 0.2s",u.value.style.width="0",o.isOk=!1):(d.value.style.transition="none",d.value.style.left=l.width-l.height+"px",u.value.style.width=l.width-l.height/2+"px",D()),o.isMoving=!1}},D=()=>{s("update:value",!0),o.isMoving=!1,u.value.style.background=l.completedBg,n.value.style["-webkit-text-fill-color"]="unset",n.value.style.animation="slidetounlock2 3s infinite",n.value.style.color="#fff",s("passCallback")};return a({reset:()=>{d.value.style.left="0",u.value.style.width="0",d.value.children[0].innerHTML=l.handlerIcon,n.value.style["-webkit-text-fill-color"]="transparent",n.value.style.animation="slidetounlock 3s infinite",n.value.style.color=l.background,s("update:value",!1),o.isOk=!1,o.isMoving=!1,o.x=0}}),(e,a)=>(T(),k("div",{ref_key:"dragVerify",ref:i,class:"drag_verify",style:C,onMousemove:U,onMouseup:A,onMouseleave:A,onTouchmove:U,onTouchend:A},[M("div",{class:B(["dv_progress_bar",{goFirst2:L(r)}]),ref_key:"progressBar",ref:u,style:R},null,2),M("div",{class:"dv_text",style:X,ref_key:"messageRef",ref:n},[e.$slots.textBefore?$(e.$slots,"textBefore",{key:0},void 0,!0):I("",!0),V(" "+P(L(j))+" ",1),e.$slots.textAfter?$(e.$slots,"textAfter",{key:1},void 0,!0):I("",!0)],512),M("div",{class:B(["dv_handler dv_handler_bg",{goFirst:L(r)}]),onMousedown:H,onTouchstart:H,ref_key:"handler",ref:d,style:S},[M("i",{class:"iconfont-sys",innerHTML:e.value?e.successIcon:e.handlerIcon},null,8,ce)],34)],544))}}),[["__scopeId","data-v-61236fff"]]);class pe{static async tip(e,a=!0){const{msg:t,detailMsg:s}=e;S({title:"操作提示",message:C("div",null,[C(R,{type:"danger"},t),s&&a&&C(X,{expandIconPosition:"left"},[C(j,{title:"详情",style:{maxHeight:"600px",overflowY:"auto"}},(()=>C(R,{type:"danger"},s)))])].filter(Boolean)),confirmButtonText:"确认",cancelButtonText:"复制",showCancelButton:a&&Boolean(s),showClose:!1,closeOnClickModal:!1,closeOnPressEscape:!1,draggable:!0}).then((()=>{})).catch((e=>{"cancel"===e&&s&&(async e=>{try{await navigator.clipboard.writeText(e),H.success("已复制详情到剪切板")}catch(a){H.error("复制失败")}})(s)}))}}const he={class:"login"},ve={class:"right-wrap"},fe={class:"top-right-wrap"},me={class:"iconfont-sys"},ye={class:"menu-txt"},xe={key:0,class:"iconfont-sys icon-check"},we={class:"header"},be={class:"login-wrap"},_e={class:"form"},ke={class:"title"},Te={class:"sub-title"},Me={class:"drag-verify"},Be={class:"forget-password"},Le={style:{"margin-top":"30px"}},$e={class:"footer"},Ie=e(f({name:"Login",__name:"index",setup(e){const{t:f}=a(),y=t(),{isDark:b,systemThemeType:$}=U(y),S=x(),C=s(),R=z(),X=x(!1),j=x(!1),ce=x(!1),Ie=l.systemInfo.name,Ve=x(),Pe=m({username:"",password:"",rememberPassword:!0}),Se=_((()=>({username:[{required:!0,message:f("login.placeholder[0]"),trigger:"blur"}],password:[{required:!0,message:f("login.placeholder[1]"),trigger:"blur"}]}))),Ce=x(!1),{width:Re}=o();w((async()=>{await(async()=>{let{data:e,success:a}=await ue.getDataByKey({dataKey:"iboot-studio.slide-validator.enabled"});a&&(ce.value="true"===e)})()}));const Xe=async()=>{Ve.value&&await Ve.value.validate((async e=>{if(e){if(ce.value&&!X.value)return void(j.value=!0);Ce.value=!0;const e={userName:Pe.username,password:g.SHA256(Pe.password).toString(g.enc.Hex),rememberPassword:Pe.rememberPassword};try{const a=await p.login(e);if(a.code===h.success){const{saTokenInfo:e}=a.data;if(e?.tokenValue){C.setSaTokenInfo(e);const a=await p.getUserInfo();C.setLoginStatus(!0),a.code===h.success?(C.setUserInfo(a.data),C.setLoginStatus(!0),await R.push(v),He()):H.error(a.msg)}}else await pe.tip(a,!0),Ce.value=!1,je()}finally{Ce.value=!1,je()}}}))},je=()=>{S.value?.reset()},He=()=>{setTimeout((()=>{ne({title:f("login.success.title"),type:"success",duration:2500,zIndex:1e4,message:`${f("login.success.message")}, ${Ie}!`})}),150)},{locale:Ue}=a(),Ae=e=>{Ue.value!==e&&(Ue.value=e,C.setLanguage(e))},De=()=>{let{LIGHT:e,DARK:a}=i;n().switchThemeStyles($.value===e?a:e)};return(e,a)=>{const t=de,s=G,l=N,o=E,i=r,n=O,g=ee,p=Z,h=ge,v=oe,f=Y("RouterLink"),m=ie,y=K,x=q("ripple");return T(),k("div",he,[A(t),M("div",ve,[M("div",fe,[M("div",{class:"btn theme-btn",onClick:De},[M("i",me,P(L(b)?"":""),1)]),A(o,{onCommand:Ae,"popper-class":"langDropDownStyle"},{dropdown:D((()=>[A(l,null,{default:D((()=>[(T(!0),k(Q,null,W(L(d),(e=>(T(),k("div",{key:e.value,class:"lang-btn-item"},[A(s,{command:e.value,class:B({"is-selected":L(Ue)===e.value})},{default:D((()=>[M("span",ye,P(e.label),1),L(Ue)===e.value?(T(),k("i",xe,"")):I("",!0)])),_:2},1032,["command","class"])])))),128))])),_:1})])),default:D((()=>[a[4]||(a[4]=M("div",{class:"btn language-btn"},[M("i",{class:"iconfont-sys icon-language"},"")],-1))])),_:1,__:[4]})]),M("div",we,[A(i,{class:"icon"}),M("h1",null,P(L(Ie)),1)]),M("div",be,[M("div",_e,[M("h3",ke,P(e.$t("login.title")),1),M("p",Te,[a[6]||(a[6]=V("关注微信公号 ")),A(n,{target:"_blank",type:"primary",underline:"always",href:"./iboot/iboot_wx_pub.jpg"},{default:D((()=>a[5]||(a[5]=[V("iboot ")]))),_:1,__:[5]}),a[7]||(a[7]=V(' 回复 "iboot" 获取账户密码登录体验。 '))]),A(y,{ref_key:"formRef",ref:Ve,model:L(Pe),rules:L(Se),onKeyup:F(Xe,["enter"]),style:{"margin-top":"25px"}},{default:D((()=>[A(p,{prop:"username"},{default:D((()=>[A(g,{placeholder:e.$t("login.placeholder[0]"),modelValue:L(Pe).username,"onUpdate:modelValue":a[0]||(a[0]=e=>L(Pe).username=e),modelModifiers:{trim:!0},"prefix-icon":L(ae)},null,8,["placeholder","modelValue","prefix-icon"])])),_:1}),A(p,{prop:"password"},{default:D((()=>[A(g,{placeholder:e.$t("login.placeholder[1]"),modelValue:L(Pe).password,"onUpdate:modelValue":a[1]||(a[1]=e=>L(Pe).password=e),modelModifiers:{trim:!0},"prefix-icon":L(te),type:"password",radius:"8px","show-password":"",autocomplete:"off"},null,8,["placeholder","modelValue","prefix-icon"])])),_:1}),J(M("div",Me,[M("div",{class:B(["drag-verify-content",{error:!L(X)&&L(j)}])},[A(h,{ref_key:"dragVerify",ref:S,value:L(X),"onUpdate:value":a[2]||(a[2]=e=>se(X)?X.value=e:null),width:L(Re)<500?328:438,text:e.$t("login.sliderText"),textColor:"var(--art-gray-800)",successText:e.$t("login.sliderSuccessText"),progressBarBg:L(u)("--el-color-primary"),background:"var(--art-gray-200)",handlerBg:"var(--art-main-bg-color)"},null,8,["value","width","text","successText","progressBarBg"])],2),M("p",{class:B(["error-text",{"show-error-text":!L(X)&&L(j)}])},P(e.$t("login.placeholder[2]")),3)],512),[[le,L(ce)]]),M("div",Be,[A(v,{modelValue:L(Pe).rememberPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>L(Pe).rememberPassword=e)},{default:D((()=>[V(P(e.$t("login.rememberPwd")),1)])),_:1},8,["modelValue"]),A(f,{to:L(c).ForgetPassword},{default:D((()=>[V(P(e.$t("login.forgetPwd")),1)])),_:1},8,["to"])]),M("div",Le,[J((T(),re(m,{class:"login-btn",type:"primary",onClick:Xe,loading:L(Ce)},{default:D((()=>[V(P(e.$t("login.btnText")),1)])),_:1},8,["loading"])),[[x]])]),M("div",$e,[M("p",null,[V(P(e.$t("login.noAccount"))+" ",1),A(f,{to:L(c).Register},{default:D((()=>[V(P(e.$t("login.register")),1)])),_:1},8,["to"])])])])),_:1},8,["model","rules"])])])])])}}}),[["__scopeId","data-v-80b0394b"]]);export{Ie as default};
