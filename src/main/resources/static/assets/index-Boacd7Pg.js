var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r,n=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&s(e,l,a[l]);if(r)for(var l of r(a))o.call(a,l)&&s(e,l,a[l]);return e},u=(e,a,l)=>new Promise(((r,t)=>{var o=e=>{try{n(l.next(e))}catch(a){t(a)}},s=e=>{try{n(l.throw(e))}catch(a){t(a)}},n=e=>e.done?r(e.value):Promise.resolve(e.value).then(o,s);n((l=l.apply(e,a)).next())}));import{u as i,_ as d,a as p,b as m,A as c}from"./useCheckedColumns-CoVoL7zl.js";import{U as g,f as b,K as f,_ as v}from"./index-BywNBzKr.js";/* empty css                */import{_ as y}from"./ArtTable-BAxfRubI.js";/* empty css                    */import{R as h}from"./roleApi-QSxTGOWg.js";import{S as _}from"./sysApi-fRs6P3xq.js";import{k as V,r as j,a2 as P,e as C,E as k,S,t as w,y as N,z as x,x as I,i as U,u as O,b9 as z,P as R,T,m as A,I as q,J as L,a_ as E,ba as $,a6 as B,a3 as K,a4 as D,L as F,ad as J,ae as Q,_ as W,bb as G,aw as H}from"./vendor-C0Cq8Zey.js";import"./formEnum-BLgiZVxV.js";import"./vue-draggable-plus-CEKPM1PI.js";/* empty css               *//* empty css               *//* empty css                       *//* empty css                       *//* empty css                   *//* empty css                 */const M={class:"account-page",id:"table-full-screen"},X={class:"dialog-footer"};var Y;const Z=v(V((Y=n({},{name:"User"}),a(Y,l({__name:"index",setup(e){const a=j([]),l=j("add"),r=j(!1),t=j(!1),o={name:"",phone:"",address:"",level:"",email:"",date:"",daterange:"",status:"1"},s=j([]),v=P(n({},o)),V=P({currentPage:1,pageSize:20,total:0}),Y=j([]),Z=j(),ee=j([]),ae=()=>{Object.assign(v,n({},o)),V.currentPage=1,ce()},le=()=>{V.currentPage=1,ce()},re=e=>{},te=[{label:"用户名",prop:"name",type:"input",config:{clearable:!0},onChange:re},{label:"电话",prop:"phone",type:"input",config:{clearable:!0},onChange:re},{label:"用户等级",prop:"level",type:"select",config:{clearable:!0},options:()=>[{label:"普通用户",value:"normal"},{label:"VIP用户",value:"vip"},{label:"高级VIP",value:"svip"},{label:"企业用户",value:"enterprise",disabled:!0}],onChange:re},{label:"地址",prop:"address",type:"input",config:{clearable:!0},onChange:re},{label:"邮箱",prop:"email",type:"input",config:{clearable:!0},onChange:re},{prop:"date",label:"日期",type:"date",config:{type:"date",placeholder:"请选择日期"}},{prop:"daterange",label:"日期范围",type:"daterange",config:{type:"daterange",startPlaceholder:"开始时间",endPlaceholder:"结束时间"}},{label:"状态",prop:"status",type:"radio",options:[{label:"在线",value:"1"},{label:"离线",value:"2"}],onChange:re}],oe=[{label:"勾选",type:"selection"},{label:"用户名",prop:"avatar"},{label:"手机号",prop:"mobile"},{label:"性别",prop:"gender"},{label:"角色",prop:"role"},{label:"状态",prop:"userStatus"},{label:"创建日期",prop:"createTime"},{label:"操作",prop:"operation"}],se=e=>{switch(e){case 1:return"success";case 2:default:return"info";case 3:return"warning";case 0:return"danger"}},ne=(e,a)=>{r.value=!0,l.value=e,de.value&&de.value.resetFields(),"edit"===e&&a?(pe.value=n({},a),pe.value.roleIds=Array.isArray(a.userRoles)?a.userRoles:[]):(pe.value.userName="",pe.value.mobile="",pe.value.gender=0,pe.value.roleIds=[])},{columnChecks:ue,columns:ie}=i((()=>[{type:"selection"},{prop:"avatar",label:"用户名",minWidth:220,formatter:e=>W("div",{class:"user",style:"display: flex; align-items: center"},[e.avatar?W("img",{class:"avatar",src:e.avatar}):f(e.realName),W("div",{},[W("p",{class:"user-name"},`${e.realName} | ${e.userName}`),W("p",{class:"email"},e.email)])])},{prop:"gender",label:"性别",sortable:!0,formatter:e=>{const l=a.value.find((a=>a.value===e.gender));return(null==l?void 0:l.label)||"未知"}},{prop:"mobile",label:"手机号"},{prop:"userStatus",label:"状态",formatter:e=>W(G,{type:se(e.userStatus)},(()=>(e=>{let a="";return 0===e?a="禁用":1===e?a="启用":3===e?a="异常":4===e&&(a="注销"),a})(e.userStatus)))},{prop:"createTime",label:"创建日期",sortable:!0},{prop:"operation",label:"操作",width:150,formatter:e=>W("div",[W(c,{type:"edit",onClick:()=>ne("edit",e)}),W(c,{type:"delete",onClick:()=>{H.confirm("确定要注销该用户吗？","注销用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then((()=>{k.success("注销成功")}))}})])}])),de=j(),pe=j({userId:"",userName:"",realName:"",gender:1,email:"",mobile:"",avatar:"",intro:"",roleIds:[]});C((()=>{ce(),ge(),me()}));const me=()=>u(this,null,(function*(){var e;const{success:l,data:r,msg:t}=yield _.getOptions({name:"gender"});if(!l)return k.error(t);a.value=(null==(e=r.find((e=>"gender"===e.name)))?void 0:e.options)||[]})),ce=()=>u(this,null,(function*(){t.value=!0;try{const e={current:V.currentPage,size:V.pageSize},a=yield g.getUserPageList(e);a.code===b.success&&(Y.value=a.data.records,t.value=!1,V.currentPage=a.data.current,V.pageSize=a.data.size,V.total=a.data.total)}catch(e){t.value=!1}})),ge=()=>u(this,null,(function*(){const e=yield h.getRolePageList({});e.success?s.value=e.data.records:k.error(e.msg)})),be=()=>{ce()},fe=e=>{ee.value=e},ve=P({userName:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],realName:[{required:!0,message:"请输入姓名",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],roleIds:[{required:!0,message:"请选择角色",trigger:"change"}]}),ye=()=>u(this,null,(function*(){if(de.value)try{yield de.value.validate();const{success:e,msg:a}=yield g.saveOrUpdate(pe.value);if(!e)return k.error(a);k.success("add"===l.value?"添加成功":"更新成功"),r.value=!1,yield ce()}catch(e){}})),he=e=>{V.pageSize=e,ce()},_e=e=>{V.currentPage=e,ce()};return(e,o)=>{const n=d,u=R,i=p,c=E,g=y,b=F,f=D,h=Q,_=J,j=K,P=z,C=m;return w(),S(C,null,{default:N((()=>[x("div",M,[I(n,{filter:O(v),"onUpdate:filter":o[0]||(o[0]=e=>U(v)?v.value=e:null),items:te,onReset:ae,onSearch:le},null,8,["filter"]),I(P,{shadow:"never",class:"art-table-card"},{default:N((()=>[I(i,{columnList:oe,columns:O(ue),"onUpdate:columns":o[2]||(o[2]=e=>U(ue)?ue.value=e:null),onRefresh:be},{left:N((()=>[I(u,{onClick:o[1]||(o[1]=e=>ne("add"))},{default:N((()=>o[12]||(o[12]=[T("新增用户")]))),_:1,__:[12]})])),_:1},8,["columns"]),I(g,{ref_key:"tableRef",ref:Z,"row-key":"id",loading:O(t),data:O(Y),currentPage:O(V).currentPage,pageSize:O(V).pageSize,total:O(V).total,marginTop:10,onSelectionChange:fe,onSizeChange:he,onCurrentChange:_e},{default:N((()=>[(w(!0),A(q,null,L(O(ie),(e=>(w(),S(c,$({key:e.prop||e.type},{ref_for:!0},e),null,16)))),128))])),_:1},8,["loading","data","currentPage","pageSize","total"]),I(O(B),{modelValue:O(r),"onUpdate:modelValue":o[11]||(o[11]=e=>U(r)?r.value=e:null),title:"add"===O(l)?"添加用户":"编辑用户",width:"30%","align-center":""},{footer:N((()=>[x("div",X,[I(u,{onClick:o[10]||(o[10]=e=>r.value=!1)},{default:N((()=>o[13]||(o[13]=[T("取消")]))),_:1,__:[13]}),I(u,{type:"primary",onClick:ye},{default:N((()=>o[14]||(o[14]=[T("提交")]))),_:1,__:[14]})])])),default:N((()=>[I(j,{ref_key:"formRef",ref:de,model:O(pe),rules:O(ve),"label-width":"80px"},{default:N((()=>[I(f,{label:"用户名",prop:"userName"},{default:N((()=>[I(b,{modelValue:O(pe).userName,"onUpdate:modelValue":o[3]||(o[3]=e=>O(pe).userName=e)},null,8,["modelValue"])])),_:1}),I(f,{label:"姓名",prop:"realName"},{default:N((()=>[I(b,{modelValue:O(pe).realName,"onUpdate:modelValue":o[4]||(o[4]=e=>O(pe).realName=e)},null,8,["modelValue"])])),_:1}),I(f,{label:"手机号",prop:"mobile"},{default:N((()=>[I(b,{modelValue:O(pe).mobile,"onUpdate:modelValue":o[5]||(o[5]=e=>O(pe).mobile=e)},null,8,["modelValue"])])),_:1}),I(f,{label:"邮箱",prop:"email"},{default:N((()=>[I(b,{modelValue:O(pe).email,"onUpdate:modelValue":o[6]||(o[6]=e=>O(pe).email=e)},null,8,["modelValue"])])),_:1}),I(f,{label:"性别",prop:"gender"},{default:N((()=>[I(_,{modelValue:O(pe).gender,"onUpdate:modelValue":o[7]||(o[7]=e=>O(pe).gender=e)},{default:N((()=>[(w(!0),A(q,null,L(O(a),(e=>(w(),S(h,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),I(f,{label:"角色",prop:"role"},{default:N((()=>[I(_,{modelValue:O(pe).roleIds,"onUpdate:modelValue":o[8]||(o[8]=e=>O(pe).roleIds=e),multiple:""},{default:N((()=>[(w(!0),A(q,null,L(O(s),(e=>(w(),S(h,{key:e.roleId,value:e.roleId,label:e.roleName},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1}),I(f,{label:"简介",prop:"intro"},{default:N((()=>[I(b,{modelValue:O(pe).intro,"onUpdate:modelValue":o[9]||(o[9]=e=>O(pe).intro=e),rows:2,type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])),_:1})])])),_:1})}}})))),[["__scopeId","data-v-4c139beb"]]);export{Z as default};
