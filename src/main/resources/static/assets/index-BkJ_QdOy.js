var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,n=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,r=(e,a)=>{for(var l in a||(a={}))u.call(a,l)&&n(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&n(e,l,a[l]);return e},i=(e,a,l)=>new Promise(((t,u)=>{var o=e=>{try{r(l.next(e))}catch(a){u(a)}},n=e=>{try{r(l.throw(e))}catch(a){u(a)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,n);r((l=l.apply(e,a)).next())}));import{u as s,_ as d,a as p,b as m,A as c}from"./useCheckedColumns-pnE256JW.js";import{j as f,c as h,C as b,I as v,D as _,_ as g}from"./index-C5W72B62.js";/* empty css                */import{_ as y}from"./ArtIconSelector-BsGZcWzB.js";/* empty css               *//* empty css               *//* empty css                       *//* empty css                        */import{_ as k}from"./ArtTable-DH080kJ_.js";/* empty css                    */import{al as V,s as w,k as j,r as x,a2 as C,e as L,c as I,D as U,S as A,t as O,y as E,z as M,x as N,i as S,u as T,b4 as H,O as P,P as q,T as B,G as D,m as R,I as z,J as F,aV as J,b5 as K,a6 as Z,a3 as $,v as G,a4 as W,aZ as Y,aY as Q,aN as X,aL as ee,L as ae,ac as le,ab as te,E as ue,n as oe,_ as ne,b6 as re,as as ie,aw as se}from"./vendor-CAvuXLR8.js";import"./formEnum-BLgiZVxV.js";import"./vue-draggable-plus-BizZuMCK.js";/* empty css                       */import"./iconfont-DPUoc2h2.js";/* empty css                   *//* empty css                 */const de=h(),pe={class:"menu-page",id:"table-full-screen"},me={class:"dialog-footer"};var ce;const fe=g(j((ce=r({},{name:"Menus"}),a(ce,l({__name:"index",setup(e){const{hasAuth:a}=(()=>{var e,a;const l=V(),{isFrontendMode:t}=f(),{info:u}=w(de),o=null!=(a=null==(e=u.value)?void 0:e.buttons)?a:[],n=Array.isArray(l.meta.authList)?l.meta.authList:[];return{hasAuth:e=>t.value?o.includes(e):n.some((a=>(null==a?void 0:a.authMark)===e))}})(),{menuList:l}=w(b()),t=x(!1),u={name:"",route:""},o=C(r({},u)),n=C(r({},u)),h=()=>{Object.assign(o,r({},u)),Object.assign(n,r({},u)),je()},g=()=>{Object.assign(n,r({},o)),je()},j=[{label:"菜单名称",prop:"name",type:"input",config:{clearable:!0}},{label:"路由地址",prop:"route",type:"input",config:{clearable:!0}}],ce=[{label:"勾选",type:"selection"},{label:"用户名",prop:"avatar"},{label:"手机号",prop:"mobile"},{label:"性别",prop:"sex"},{label:"部门",prop:"dep"},{label:"状态",prop:"status"},{label:"创建日期",prop:"create_time"},{label:"操作",prop:"operation"}],fe=e=>{var a,l,t;return e.children&&e.children.length>0?"info":(null==(a=e.meta)?void 0:a.link)&&(null==(l=e.meta)?void 0:l.isIframe)?"success":e.path?"primary":(null==(t=e.meta)?void 0:t.link)?"warning":void 0},{columnChecks:he,columns:be}=s((()=>[{prop:"meta.title",label:"菜单名称",minWidth:120,formatter:e=>{var a;return _(null==(a=e.meta)?void 0:a.title)}},{prop:"type",label:"菜单类型",formatter:e=>ne(re,{type:fe(e)},(()=>(e=>{var a,l,t,u;return e.children&&e.children.length>0?"目录":(null==(a=e.meta)?void 0:a.link)&&(null==(l=e.meta)?void 0:l.isIframe)?"菜单（内嵌）":e.path&&!(null==(t=e.meta)?void 0:t.link)?"菜单":(null==(u=e.meta)?void 0:u.link)?"菜单（外链）":void 0})(e)))},{prop:"path",label:"路由",formatter:e=>{var a;return(null==(a=e.meta)?void 0:a.link)||e.path||""}},{prop:"meta.authList",label:"可操作权限",formatter:e=>{var a;return ne("div",{},null==(a=e.meta.authList)?void 0:a.map(((e,a)=>ne(ie,{placement:"top-start",title:"操作",width:200,trigger:"click",key:a},{default:()=>ne("div",{style:"margin: 0; text-align: right"},[ne(q,{size:"small",type:"primary",onClick:()=>Ee("button",e)},{default:()=>"编辑"}),ne(q,{size:"small",type:"danger",onClick:()=>Se()},{default:()=>"删除"})]),reference:()=>ne(q,{class:"small-btn"},{default:()=>e.title})}))))}},{prop:"date",label:"编辑时间",formatter:()=>"2022-3-12 12:00:00"},{prop:"status",label:"隐藏菜单",formatter:e=>ne(re,{type:e.meta.isHide?"danger":"info"},(()=>e.meta.isHide?"是":"否"))},{prop:"operation",label:"操作",width:180,formatter:e=>ne("div",[a("menu/add")&&ne(c,{type:"add",onClick:()=>Ee("menu")}),a("menu/update")&&ne(c,{type:"edit",onClick:()=>Ue("edit",e)}),a("menu/del")&&ne(c,{type:"delete",onClick:()=>Ne()})])}])),ve=()=>{je()},_e=x(!1),ge=C({name:"",path:"",label:"",icon:"",isEnable:!0,sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1}),ye=x(v.UNICODE),ke=x("menu"),Ve=C({name:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],label:[{required:!0,message:"输入权限标识",trigger:"blur"}],authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}],authLabel:[{required:!0,message:"请输入权限权限标识",trigger:"blur"}]}),we=x([]);L((()=>{je()}));const je=()=>{t.value=!0,setTimeout((()=>{we.value=l.value,t.value=!1}),500)},xe=I((()=>{const e=a=>a.filter((a=>{var l,t,u;const o=(null==(l=n.name)?void 0:l.toLowerCase().trim())||"",r=(null==(t=n.route)?void 0:t.toLowerCase().trim())||"",i=_((null==(u=a.meta)?void 0:u.title)||"").toLowerCase(),s=(a.path||"").toLowerCase(),d=!o||i.includes(o),p=!r||s.includes(r);if(a.children&&a.children.length>0){const l=e(a.children);if(l.length>0)return a.children=l,!0}return d&&p}));return e(we.value)})),Ce=x(!1),Le=x(),Ie=I((()=>{const e="menu"===ke.value?"菜单":"权限";return Ce.value?`编辑${e}`:`新建${e}`})),Ue=(e,a)=>{Ee("menu",a,!0)},Ae=()=>{},Oe=()=>i(this,null,(function*(){Le.value&&(yield Le.value.validate((e=>i(this,null,(function*(){if(e)try{Ce.value,ue.success((Ce.value?"编辑":"新增")+"成功"),_e.value=!1}catch(a){ue.error((Ce.value?"编辑":"新增")+"失败")}})))))})),Ee=(e,a,l=!1)=>{_e.value=!0,ke.value=e,Ce.value=!1,He.value=l,Me(),a&&(Ce.value=!0,oe((()=>{"menu"===e?(ge.name=_(a.meta.title),ge.path=a.path,ge.label=a.name,ge.icon=a.meta.icon,ge.sort=a.meta.sort||1,ge.isMenu=a.meta.isMenu,ge.keepAlive=a.meta.keepAlive,ge.isHidden=a.meta.isHidden||!0,ge.isEnable=a.meta.isEnable||!0,ge.link=a.meta.link,ge.isIframe=a.meta.isIframe||!1):(ge.authName=a.title,ge.authLabel=a.authMark,ge.authIcon=a.icon||"",ge.authSort=a.sort||1)})))},Me=()=>{var e;null==(e=Le.value)||e.resetFields(),Object.assign(ge,{name:"",path:"",label:"",icon:"",sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1})},Ne=()=>i(this,null,(function*(){try{yield se.confirm("确定要删除该菜单吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),ue.success("删除成功")}catch(e){"cancel"!==e&&ue.error("删除失败")}})),Se=()=>i(this,null,(function*(){try{yield se.confirm("确定要删除该权限吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),ue.success("删除成功")}catch(e){"cancel"!==e&&ue.error("删除失败")}})),Te=I((()=>!(!Ce.value||"button"!==ke.value)||!(!Ce.value||"menu"!==ke.value)||!(Ce.value||"menu"!==ke.value||!He.value))),He=x(!1),Pe=x(!1),qe=x(),Be=()=>{Pe.value=!Pe.value,oe((()=>{qe.value&&qe.value[Pe.value?"expandAll":"collapseAll"]()}))};return(e,a)=>{const l=d,u=p,n=J,r=k,i=Q,s=Y,c=W,f=ae,b=ee,v=X,_=y,V=le,w=te,x=$,C=Z,L=H,I=m,ue=U("auth"),oe=U("ripple");return O(),A(I,null,{default:E((()=>[M("div",pe,[N(l,{filter:T(o),"onUpdate:filter":a[0]||(a[0]=e=>S(o)?o.value=e:null),items:j,showExpand:!1,onReset:h,onSearch:g},null,8,["filter"]),N(L,{shadow:"never",class:"art-table-card"},{default:E((()=>[N(u,{columnList:ce,showZebra:!1,columns:T(he),"onUpdate:columns":a[2]||(a[2]=e=>S(he)?he.value=e:null),onRefresh:ve},{left:E((()=>[P((O(),A(T(q),{onClick:a[1]||(a[1]=e=>Ee("menu",null,!0))},{default:E((()=>a[19]||(a[19]=[B(" 添加菜单 ")]))),_:1,__:[19]})),[[ue,"menu/add"],[oe]]),P((O(),A(T(q),{onClick:Be},{default:E((()=>[B(D(T(Pe)?"收起":"展开"),1)])),_:1})),[[oe]])])),_:1},8,["columns"]),N(r,{rowKey:"path",ref_key:"tableRef",ref:qe,loading:T(t),data:T(xe),marginTop:10,stripe:!1},{default:E((()=>[(O(!0),R(z,null,F(T(be),(e=>(O(),A(n,K({key:e.prop||e.type},{ref_for:!0},e),null,16)))),128))])),_:1},8,["loading","data"]),N(C,{title:T(Ie),modelValue:T(_e),"onUpdate:modelValue":a[18]||(a[18]=e=>S(_e)?_e.value=e:null),width:"700px","align-center":""},{footer:E((()=>[M("span",me,[N(T(q),{onClick:a[16]||(a[16]=e=>_e.value=!1)},{default:E((()=>a[22]||(a[22]=[B("取 消")]))),_:1,__:[22]}),N(T(q),{type:"primary",onClick:a[17]||(a[17]=e=>Oe())},{default:E((()=>a[23]||(a[23]=[B("确 定")]))),_:1,__:[23]})])])),default:E((()=>[N(x,{ref_key:"formRef",ref:Le,model:T(ge),rules:T(Ve),"label-width":"85px"},{default:E((()=>[N(c,{label:"菜单类型"},{default:E((()=>[N(s,{modelValue:T(ke),"onUpdate:modelValue":a[3]||(a[3]=e=>S(ke)?ke.value=e:null),disabled:T(Te)},{default:E((()=>[N(i,{value:"menu",label:"menu"},{default:E((()=>a[20]||(a[20]=[B("菜单")]))),_:1,__:[20]}),N(i,{value:"button",label:"button"},{default:E((()=>a[21]||(a[21]=[B("权限")]))),_:1,__:[21]})])),_:1},8,["modelValue","disabled"])])),_:1}),"menu"===T(ke)?(O(),R(z,{key:0},[N(v,{gutter:20},{default:E((()=>[N(b,{span:12},{default:E((()=>[N(c,{label:"菜单名称",prop:"name"},{default:E((()=>[N(f,{modelValue:T(ge).name,"onUpdate:modelValue":a[4]||(a[4]=e=>T(ge).name=e),placeholder:"菜单名称"},null,8,["modelValue"])])),_:1})])),_:1}),N(b,{span:12},{default:E((()=>[N(c,{label:"路由地址",prop:"path"},{default:E((()=>[N(f,{modelValue:T(ge).path,"onUpdate:modelValue":a[5]||(a[5]=e=>T(ge).path=e),placeholder:"路由地址"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),N(v,{gutter:20},{default:E((()=>[N(b,{span:12},{default:E((()=>[N(c,{label:"权限标识",prop:"label"},{default:E((()=>[N(f,{modelValue:T(ge).label,"onUpdate:modelValue":a[6]||(a[6]=e=>T(ge).label=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1}),N(b,{span:12},{default:E((()=>[N(c,{label:"图标",prop:"icon"},{default:E((()=>[N(_,{iconType:T(ye),defaultIcon:T(ge).icon,width:"229px"},null,8,["iconType","defaultIcon"])])),_:1})])),_:1})])),_:1}),N(v,{gutter:20},{default:E((()=>[N(b,{span:12},{default:E((()=>[N(c,{label:"菜单排序",prop:"sort",style:{width:"100%"}},{default:E((()=>[N(V,{modelValue:T(ge).sort,"onUpdate:modelValue":a[7]||(a[7]=e=>T(ge).sort=e),style:{width:"100%"},onChange:Ae,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1}),N(b,{span:12},{default:E((()=>[N(c,{label:"外部链接",prop:"link"},{default:E((()=>[N(f,{modelValue:T(ge).link,"onUpdate:modelValue":a[8]||(a[8]=e=>T(ge).link=e),placeholder:"外部链接/内嵌地址(https://www.baidu.com)"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),N(v,{gutter:20},{default:E((()=>[N(b,{span:5},{default:E((()=>[N(c,{label:"是否启用",prop:"isEnable"},{default:E((()=>[N(w,{modelValue:T(ge).isEnable,"onUpdate:modelValue":a[9]||(a[9]=e=>T(ge).isEnable=e)},null,8,["modelValue"])])),_:1})])),_:1}),N(b,{span:5},{default:E((()=>[N(c,{label:"页面缓存",prop:"keepAlive"},{default:E((()=>[N(w,{modelValue:T(ge).keepAlive,"onUpdate:modelValue":a[10]||(a[10]=e=>T(ge).keepAlive=e)},null,8,["modelValue"])])),_:1})])),_:1}),N(b,{span:5},{default:E((()=>[N(c,{label:"是否显示",prop:"isHidden"},{default:E((()=>[N(w,{modelValue:T(ge).isHidden,"onUpdate:modelValue":a[11]||(a[11]=e=>T(ge).isHidden=e)},null,8,["modelValue"])])),_:1})])),_:1}),N(b,{span:5},{default:E((()=>[N(c,{label:"是否内嵌",prop:"isMenu"},{default:E((()=>[N(w,{modelValue:T(ge).isIframe,"onUpdate:modelValue":a[12]||(a[12]=e=>T(ge).isIframe=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):G("",!0),"button"===T(ke)?(O(),R(z,{key:1},[N(v,{gutter:20},{default:E((()=>[N(b,{span:12},{default:E((()=>[N(c,{label:"权限名称",prop:"authName"},{default:E((()=>[N(f,{modelValue:T(ge).authName,"onUpdate:modelValue":a[13]||(a[13]=e=>T(ge).authName=e),placeholder:"权限名称"},null,8,["modelValue"])])),_:1})])),_:1}),N(b,{span:12},{default:E((()=>[N(c,{label:"权限标识",prop:"authLabel"},{default:E((()=>[N(f,{modelValue:T(ge).authLabel,"onUpdate:modelValue":a[14]||(a[14]=e=>T(ge).authLabel=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),N(v,{gutter:20},{default:E((()=>[N(b,{span:12},{default:E((()=>[N(c,{label:"权限排序",prop:"authSort",style:{width:"100%"}},{default:E((()=>[N(V,{modelValue:T(ge).authSort,"onUpdate:modelValue":a[15]||(a[15]=e=>T(ge).authSort=e),style:{width:"100%"},onChange:Ae,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):G("",!0)])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])),_:1})])])),_:1})}}})))),[["__scopeId","data-v-0e6e1e77"]]);export{fe as default};
